# $Id: PKGBUILD 208896 2014-03-28 14:01:08Z dreisner $
# Maintainer: Dave Reisner <dreisner@archlinux.org>
# Contributor: Angel Velasquez <angvp@archlinux.org>
# Contributor: Eric Belanger <eric@archlinux.org>
# Contributor: Lucien Immink <l.immink@student.fnt.hvu.nl>
# Contributor: Daniel J Griffiths <ghost1227@archlinux.us>

pkgname=pth-curl
_pkgname=curl
pkgver=7.37.0
pkgrel=1
pkgdesc="An URL retrieval utility and library: patched for passing the hash toolkit"
arch=('i686' 'x86_64' 'armv6h' 'armv7h')
url="http://curl.haxx.se"
license=('MIT')
depends=('libidn' 'rtmpdump')
options=('staticlibs')
source=("http://curl.haxx.se/download/$_pkgname-$pkgver.tar.gz"{,.asc}
        "https://passing-the-hash.googlecode.com/svn/trunk/kali-build/patches/curl-pth-ntlm.patch")
sha512sums=('738c643487f27dc89d362f40c6d7414b1708398f6cc382696594630f5ad2ddb13ede4c9b90c1e60d4aab83667b7acdb736bdb824b088d6ebfafa0f9f8f964216'
            'SKIP'
            'af04987fba82832d652286f391837e6a30d24906f30c28d6d0a61bf4c54d068aa8017e4c90eb7dc21a41e44cfa96c0ba303bacb60e006a90152a32d39a4076dd')

prepare(){
  cd "$_pkgname-$pkgver"
  patch -p1 -i "$srcdir/curl-pth-ntlm.patch"
}

build() {
  cd "$_pkgname-$pkgver"

  ./configure --with-gssapi --enable-static --disable-shared
  make
}

package() {
  cd "$_pkgname-$pkgver"

  install -Dm755 src/curl $pkgdir/usr/bin/pth-curl

  # license
  install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"

}
