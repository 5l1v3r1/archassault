# Maintainer: ArchAssault <team@archassault.org>
pkgname=pth-curl
pkgver=7.37.0
pkgrel=1
pkgdesc="An URL retrieval utility and library: patched for passing the hash toolkit"
groups=('archassault' 'archassault-passthehash')
arch=('i686' 'x86_64' 'armv6h' 'armv7h')
url="http://curl.haxx.se"
license=('MIT')
depends=('libidn' 'rtmpdump' 'libssh2' 'krb5')
options=('staticlibs')
source=("http://curl.haxx.se/download/curl-${pkgver}.tar.gz"
        "https://passing-the-hash.googlecode.com/svn/trunk/kali-build/patches/curl-pth-ntlm.patch")
sha512sums=('738c643487f27dc89d362f40c6d7414b1708398f6cc382696594630f5ad2ddb13ede4c9b90c1e60d4aab83667b7acdb736bdb824b088d6ebfafa0f9f8f964216'
            'af04987fba82832d652286f391837e6a30d24906f30c28d6d0a61bf4c54d068aa8017e4c90eb7dc21a41e44cfa96c0ba303bacb60e006a90152a32d39a4076dd')

build() {
  cd "curl-${pkgver}"
  patch -p1 -i "${srcdir}/curl-pth-ntlm.patch"
  ./configure --with-gssapi --enable-static --disable-shared
  make
}

package() {
  cd "curl-${pkgver}"
  install -Dm644 COPYING ${pkgdir}/usr/share/licenses/${pkgname}/COPYING
  install -Dm755 src/curl ${pkgdir}/usr/bin/pth-curl
}
