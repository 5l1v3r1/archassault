# Maintainer: ArchAssault <team@archassault.org>

pkgname=xsscrapy
pkgver=20140811.r1363
pkgrel=1
pkgdesc="xss spider"
arch=('any')
url="https://github.com/DanMcInerney/xsscrapy"
license=('BSD')
depends=('python2' 'scrapy')
makedepends=('git')
options=('staticlibs' '!strip')
source=("${pkgname}::git+https://github.com/DanMcInerney/${pkgname}.git"
	'LICENSE')
sha512sums=('SKIP'
            'e1a31da9906b07891085900f3e4b17b1b8a5274b5f12068f8dd7ff80fe8682dc9011c3c26b0e2716092ebf938bbc3d6dc6891036009a8122d34dfb1536ea1093')

pkgver() {
    cd "${pkgname}"
    printf "%s.r%s.%s" "$(git show -s --format=%ci master | sed 's/\ .*//g;s/-//g')" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}


package() {
    cd "${pkgname}"
    install -dm755 "${pkgdir}"/usr/share/${pkgname}
    cp -a --no-preserve=ownership tests "${pkgdir}"/usr/share/${pkgname}/
    cp -a --no-preserve=ownership xsscrapy "${pkgdir}"/usr/share/${pkgname}/
    install -Dm644 README.md "${pkgdir}"/usr/share/${pkgname}/README.md
    install -Dm755 loginform.py "${pkgdir}"/usr/share/${pkgname}/loginform.py
    install -Dm644 scrapy.cfg "${pkgdir}"/usr/share/${pkgname}/scrapy.cfg
    install -Dm644 "${srcdir}"/LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
